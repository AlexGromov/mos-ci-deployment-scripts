- job:
    name: 8.0-superjob_for_TEMPEST_VLAN_DVR_CEILOMETER_MONGO
    builders:
      - shell: |
          ISO_DIR='/var/www/fuelweb-iso'
          sudo rm -rf "$ISO_DIR"
          sudo wget http://srv52-bud.infra.mirantis.net/fuelweb-iso/fuel-8.0-570-2016-02-15_13-42-00.iso -P "$ISO_DIR"
          sudo echo '' > /home/*/.ssh/known_hosts
      - trigger-builds:
        - project: 'create_param_environment'
          same-node: true
          block: true
          predefined-parameters: |
            # BOOL_VARS="L2_POP_ENABLE DVR_ENABLE L3_HA_ENABLE SAHARA_ENABLE MURANO_ENABLE CEILOMETER_ENABLE IRONIC_ENABLE RADOS_ENABLE"
            SNAPSHOT_NAME=ha_deploy_VLAN_DVR_CEILOMETER_MONGO_CINDER
            TEST_TYPE=TEMPEST, Cinder LVM, Swift
            SEGMENT_TYPE=VLAN
            DISABLE_SSL=TRUE
            DVR_ENABLE=TRUE
            CEILOMETER_ENABLE=TRUE
            IRONIC_ENABLE=FALSE
            MONGO_ENABLE=TRUE
            NOVA_QUOTAS_ENABLED=TRUE
            SLAVE_NODE_CPU=2
            SLAVE_NODE_MEMORY=8192
            CHANGE_CONF_YAML=NO
            DEPLOYMENT_TIMEOUT=15000
            FUEL_QA_VER=stable/8.0
            TEMPEST=TRUE

      - trigger-builds:
        - project: '8.0-tempest-VLAN_DVR_CEILOMETER_MONGO'
          same-node: true
          block: true
          block-thresholds:
            build-step-failure-threshold: 'never'
          predefined-parameters: |
            SNAPSHOT_NAME=ha_deploy_VLAN_DVR_CEILOMETER_MONGO_CINDER
            REPORT_PREFIX=/srv/jenkins/rally-tempest

      - trigger-builds:
        - project: 'test_rail_reporter'
          same-node: true
          block: true
          predefined-parameters: |
            SNAPSHOT_NAME=ha_deploy_VLAN_DVR_CEILOMETER_MONGO_CINDER
            TEST_GROUP='TEMPEST,HA,Cinder LVM,Swift'
            REPORT_PREFIX=/srv/jenkins/rally-tempest
            REPORT_FILE=verification.xml
            SUITE=[8.0][MOSQA] Tempest 8.0

#    triggers:
#        - timed: "30 21 * * *"
    project-type: freestyle
    defaults: global
    node: Slave-7777
    description: 'VLAN+DVR+CEILOMETER+MONGO TEMPEST tests'
    disabled: false
    display-name: '8.0-superjob_for_TEMPEST_VLAN_DVR_CEILOMETER_MONGO'
    concurrent: false
    retry-count: 3
    logrotate:
      daysToKeep: 5
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
