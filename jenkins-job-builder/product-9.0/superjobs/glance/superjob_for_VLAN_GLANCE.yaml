- job:
    name: 9.0-superjob_for_VLAN_GLANCE_multijob
    project-type: multijob

    parameters:
        #EnvInject file
        - string:
            name: ENV_INJECT_PATH
            default: "/home/jenkins/env_inject.properties"

        # Deply environment parameters
        - string:
            name: SNAPSHOT_NAME
            default: "ha_deploy_VLAN_CINDER"
        - string:
            name: TEST_TYPE
            default: "GLANCE"
        - string:
            name: SEGMENT_TYPE
            default: "VLAN"
        - string:
            name: DISABLE_SSL
            default: "TRUE"
        - string:
            name: ISO_DIR
            default: "/var/www/fuelweb-iso"

        # TestRail Reporter parameters
        - string:
            name: TEST_GROUP
            default: "Glance"
        - string:
            name: TESTRAIL_FILE
            default: "/var/www/test_rail/user.sh"
        - string:
            name: REPORT_PREFIX
            default: "/srv/jenkins/glance"
        - string:
            name: REPORT_FILE
            default: "report.xml"
        - string:
            name: SUITE
            default: "[9.0][MOSQA] Tempest 9.0"
        - string:
            name: MILESTONE
            default: "9.0"

    builders:
      - shell:
          !include-raw: ../../../shell_scripts/snapshot_name_generator.sh
      - shell:
          !include-raw: ../neutron/9.0_mitaka_iso_and_erase_env.sh
      - multijob:
          name: Deploy_Env
          condition: SUCCESSFUL
          projects:
              - name: 9.0_create_param_environment
                current-parameters: true
                same-node: true
                node-label: slave-srv96
                node-label-name: slave-srv96
                abort-all-job: true
      - multijob:
          name: Run_Glance_Tests
          condition: SUCCESSFUL
          projects:
              - name: 9.0-glance_tests
                current-parameters: true
                same-node: true
                node-label: slave-srv96
                node-label-name: slave-srv96
                abort-all-job: true
      - multijob:
          name: Report To TestRail
          condition: SUCCESSFUL
          projects:
              - name: test_testrail_reporter
                current-parameters: true
                same-node: true
                node-label: slave-srv96
                node-label-name: slave-srv96
                abort-all-job: true

    defaults: global
    node: Slave-srv96
    description: '9.0-VLAN GLANCE tests'
    disabled: false
    display-name: '(9.0)(multi)Glance Tests'
    concurrent: false
    retry-count: 3
    logrotate:
      daysToKeep: 5
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1