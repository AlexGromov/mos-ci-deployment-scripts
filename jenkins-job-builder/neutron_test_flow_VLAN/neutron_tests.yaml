- scm:
    name: mos-integration-tests-repository
    scm:
      - git:
         url: https://github.com/Mirantis/mos-integration-tests.git
         branches:
          - origin/master
- job:
    name: neutron_tests
    builders:
        - shell: |
            ISO_NAME=`ls "$ISO_DIR"`
            ENV_NAME=MOS_CI_"$ISO_NAME"
            
            dos.py start "$ENV_NAME"
            py.test mos_tests/neutron -E "$ENV_NAME" -S "$SNAPSHOT_NAME" -s
    scm:
        - mos-integration-tests-repository
    parameters:
      - string:
          name: ISO_DIR
          default: /var/www/fuelweb-iso
          description: "Path to iso-file."
      - string:
          name: SNAPSHOT_NAME
          default: ha_deploy_VLAN
          description: "Snapshot's name, that is generated by script deploy_env.sh"

    project-type: freestyle
    defaults: global
    description: 'Runs mos_tests/neutron tests'
    disabled: false
    display-name: 'NEUTRON tests'
    concurrent: false
    browser: githubweb
    retry-count: 3
    logrotate:
      daysToKeep: 5
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1

