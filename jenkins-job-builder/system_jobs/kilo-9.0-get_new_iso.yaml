- job:
    name: kilo-9.0-get_new_iso
    parameters:
      - string:
          name: PARSED_LINK
          default: "https://product-ci.infra.mirantis.net/view/9.0-kilo/job/9.0-kilo.all/lastSuccessfulBuild/api/python"
      - string:
          name: ISO_DIR
          default: "/var/www/fuelweb-iso"
      - node:
          name: SLAVE_NAMES
          default-slaves:
            - Slave-srv137
            - Slave-srv138
            - Slave-srv139
            - Slave-srv140
            - Slave-srv141
            - Slave-srv142
            - Slave-srv143
            - Slave-srv144
          allowed-slaves:
            - Slave-srv137
            - Slave-srv138
            - Slave-srv139
            - Slave-srv140
            - Slave-srv141
            - Slave-srv142
            - Slave-srv143
            - Slave-srv144
            - Slave-srv145
          ignore-offline-nodes: true
          allowed-multiselect: true


    builders:
        - shell: |
             cd jenkins-job-builder/python_scripts/9.0_parse_jenkins_for_iso
             sudo python parser.py --link "$PARSED_LINK" -d "$ISO_DIR"

    project-type: freestyle
    defaults: global
    scm:
       - mos-ci-deployment-scripts
    description: 'Download last succesful ISO, that will be used for swarm'
    disabled: false
    display-name: '9.0-kilo Get new swarm-ISO'
    concurrent: true
    retry-count: 3
    logrotate:
      daysToKeep: 1
      numToKeep: 5
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    publishers:
      - email:
          recipients: efazliev@mirantis.com