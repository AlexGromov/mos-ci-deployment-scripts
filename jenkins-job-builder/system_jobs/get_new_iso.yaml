- job:
    name: get_new_iso
    parameters:
      - string:
          name: PARSED_LINK
          default: http://product-jenkins-reports.vm.mirantis.net/iso/8.0
      - string:
          name: ISO_DIR
          default: /var/www/fuelweb-iso

      - node:
          name: SLAVE_NAMES
          default-slaves:
            - Slave-srv129
            - Slave-srv130
            - Slave-srv131
            - Slave-srv132
            - Slave-srv133
            - Slave-srv134
            - Slave-srv135
            - Slave-srv136
          allowed-slaves:
            - Slave-srv129
            - Slave-srv130
            - Slave-srv131
            - Slave-srv132
            - Slave-srv133
            - Slave-srv134
            - Slave-srv135
            - Slave-srv136
          ignore-offline-nodes: true
          allowed-multiselect: true
    builders:
        - shell: |
             cd jenkins-job-builder/product/python_scripts/parse_jenkins_reports
             sudo python parser.py --link "$PARSED_LINK" -d "$ISO_DIR"

    project-type: freestyle
    defaults: global
    scm:
       - mos-ci-deployment-scripts
    description: 'Download last succesful ISO, that will be used for swarm'
    disabled: false
    display-name: 'Get new swarm-ISO'
    concurrent: true
    retry-count: 3
    logrotate:
      daysToKeep: 1
      numToKeep: 5
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    publishers:
      - email:
          recipients: efazliev@mirantis.com